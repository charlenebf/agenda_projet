<div class="calendar-container">
  <header class="calendar-header">
    <h1>Mon Agenda</h1>
    <div class="calendar-nav">
      <button (click)="previousMonth()" class="btn-nav">&lt;</button>
      <span class="current-month">{{ getCurrentMonthYear() }}</span>
      <button (click)="nextMonth()" class="btn-nav">&gt;</button>
    </div>
    <button (click)="openEventForm()" class="btn-primary">Nouvel événement</button>
  </header>

  <div class="calendar-grid">
    <div class="calendar-weekdays">
      @for (day of weekdays; track day) {
        <div class="weekday">{{ day }}</div>
      }
    </div>
    
    <div class="calendar-days">
      @for (day of calendarDays; track day.date) {
        <div 
          class="calendar-day"
          [class.other-month]="!day.isCurrentMonth"
          [class.today]="day.isToday"
          (click)="selectDay(day)"
        >
          <span class="day-number">{{ day.date.getDate() }}</span>
          <div class="day-events">
            @for (event of day.events; track event.id) {
              <div 
                class="event-item"
                [style.background-color]="event.color"
                (click)="editEvent(event, $event)"
              >
                {{ event.title }}
              </div>
            }
          </div>
        </div>
      }
    </div>
  </div>

  @if (showDayEvents && selectedDate) {
    <app-day-events
      [selectedDate]="selectedDate"
      [events]="selectedDayEvents"
      (close)="closeDayEvents()"
      (editEvent)="onEditEventFromDay($event)"
      (deleteEvent)="onDeleteEventFromDay($event)"
      (newEvent)="onNewEventFromDay($event)"
    ></app-day-events>
  }

  @if (showEventForm) {
    <app-event-form
      [event]="selectedEvent"
      [selectedDate]="selectedDate"
      (save)="onEventSave($event)"
      (cancel)="closeEventForm()"
      (delete)="onEventDelete($event)"
    ></app-event-form>
  }
</div>